import{d as T,b as f,o as t,c as o,n as $,t as h,p as U,k as q,f as i,i as y,l as W,u as b,m as I,a as C,r as M,q as F,w as j,F as w,h as V,j as X}from"./index-DaRYtvcQ.js";import{b as E,a as P,u as L,d as H,_ as Y}from"./_plugin-vue_export-helper-s9D9FR0L.js";const Z=d=>(U("data-v-87b40a96"),d=d(),q(),d),ee={key:0},te=Z(()=>i("em",null,"W/O",-1)),se=[te],le={key:2},oe=T({__name:"ScoreCell",props:{result:{}},emits:["clicked"],setup(d,{emit:_}){const l=d,u=_,r=m=>e.value||m.finishTime?"bg-primary":m.startTime?"in-progress text-white":"bg-orange-400 text-white",e=f(()=>l.result.scores.some(m=>m.isBye));return(m,s)=>(t(),o("div",{class:$(["p-2 text-center border-round-md",[r(l.result),!e.value&&"cursor-pointer"]]),onClick:s[0]||(s[0]=()=>u("clicked"))},[e.value?(t(),o("span",ee,se)):l.result.startTime?(t(),o("span",{key:1,class:$([l.result.finishTime&&"font-bold"])},h(l.result.scores.map(a=>a.score).join("-")),3)):(t(),o("span",le," ?-? "))],2))}}),ne=E(oe,[["__scopeId","data-v-87b40a96"]]),ae={key:0,class:"text-gray-400"},re=i("em",null,"(bye)",-1),ie=[re],ue={key:1},ce={key:2},de=i("em",{class:"text-gray-400"},"TBD",-1),me=[de],ve={class:"col-2 p-0"},pe={key:0,class:"text-gray-400"},he=i("em",null,"(bye)",-1),_e=[he],fe={key:1},be={key:2},ye=i("em",{class:"text-gray-400"},"TBD",-1),ge=[ye],xe={key:3},ke=T({__name:"FixtureCard",props:{result:{},highlightedResultId:{}},emits:["showResultModal","highlight"],setup(d,{emit:_}){const l=d,u=_,r=P(),e=y(l.result);W(l,()=>{e.value=l.result});const m=f(()=>l.result.scores.some(p=>p.isBye)),s=()=>{m.value||u("showResultModal")},a=p=>{p&&u("highlight",p)};return(p,v)=>(t(),o("div",{class:$(["grid m-0",[l.highlightedResultId===e.value.id&&"bg-blue-100"]])},[i("div",{class:$(["col-5",[l.highlightedResultId===e.value.parentFixtureIds[0]&&"bg-blue-100",e.value.parentFixtureIds[0]&&"cursor-pointer"]]),onClick:v[0]||(v[0]=x=>a(e.value.parentFixtureIds[0]))},[e.value.scores[0].isBye?(t(),o("span",ae,ie)):e.value.scores[0].playerId?(t(),o("span",ue,h(b(r).getPlayerName(e.value.scores[0].playerId)),1)):e.value.parentFixtureIds[0]?(t(),o("span",ce,me)):I("",!0)],2),i("div",ve,[C(ne,{result:e.value,onClicked:s},null,8,["result"])]),i("div",{class:$(["col-5 text-right",[l.highlightedResultId===e.value.parentFixtureIds[1]&&"bg-blue-100",e.value.parentFixtureIds[0]&&"cursor-pointer"]]),onClick:v[1]||(v[1]=x=>a(e.value.parentFixtureIds[1]))},[e.value.scores[1].isBye?(t(),o("span",pe,_e)):e.value.scores[1].playerId?(t(),o("span",fe,h(b(r).getPlayerName(e.value.scores[1].playerId)),1)):e.value.parentFixtureIds[1]?(t(),o("span",be,ge)):(t(),o("span",xe,h(b(r).getPlayerName(e.value.scores[1].playerId)),1))],2)],2))}}),Ie={key:0,class:"flex flex-column md:flex-row md:align-items-center justify-content-between mb-2"},$e={class:"font-bold"},Fe={key:1},we={key:0},Ce={key:1},Re={class:"flex flex-column md:flex-row md:align-items-center justify-content-between mb-2"},Te={class:"font-bold"},Se={class:"md:ml-3"},Be=i("span",{class:"pi pi-plus"},null,-1),Ne=i("span",{class:"pi pi-minus"},null,-1),De={class:"p-fluid"},Me=T({__name:"RecordResultModal",props:{visible:{type:Boolean},result:{}},emits:["hide"],setup(d,{emit:_}){const l=d,u=_,r=P(),e=L(),m=y(l.visible),s=y(l.result),a=y(l.result.scores.map(n=>n.score));W(l,()=>{m.value=l.visible,s.value=l.result,a.value=l.result.scores.map(n=>n.score)});const p=f(()=>s.value.scores.map(n=>n.playerId)),v=f(()=>r.getRound(s.value.id));W([a],()=>{var n;(n=document.activeElement)==null||n.blur()});const x=(n,c)=>{a.value=a.value.map((R,g)=>g===n?c:R)},S=()=>{r.startFixture(s.value.id),u("hide")},B=n=>{const c={id:s.value.id,parentFixtureIds:s.value.parentFixtureIds,scores:p.value.map((R,g)=>({playerId:R,score:a.value[g]})),startTime:s.value.startTime};r.updateResult(c,n),u("hide")},z=f(()=>s.value.scores.some(n=>!n.playerId)?"Waiting for a previous result":e.requireCompletedRounds&&v.value.index>r.currentRound?"Waiting for round to start":r.ongoingCount>=e.tableCount?"Waiting for a free table":"Start"),A=f(()=>s.value.scores.some(n=>!n.playerId)?!0:e.requireCompletedRounds?v.value.index>r.currentRound:r.ongoingCount>=e.tableCount),J=f(()=>!!(a.value.every(n=>n<e.raceTo)||a.value.reduce((n,c)=>n+c)>2*e.raceTo-1)),O=f(()=>s.value.scores.map(n=>n.isBye?"(bye)":r.getPlayerName(n.playerId)||"(???)").join(" v ")),G=f(()=>`${v.value.name} - ${O.value}`),N=f(()=>s.value.startTime?s.value.finishTime?H(new Date(s.value.finishTime),new Date(s.value.startTime)):H(new Date,new Date(s.value.startTime)):null);return(n,c)=>{const R=M("InputNumber"),g=M("Button"),K=M("Dialog");return t(),F(K,{visible:m.value,"onUpdate:visible":c[3]||(c[3]=k=>m.value=k),modal:"",header:G.value,onHide:c[4]||(c[4]=k=>u("hide"))},{default:j(()=>[s.value.finishTime?(t(),o("div",Ie,[i("p",null,"Took "+h(N.value)+" minute(s)",1),(t(!0),o(w,null,V(p.value,(k,D)=>(t(),o("div",$e,h(b(r).getPlayerName(k))+": "+h(a.value[D]),1))),256))])):s.value.startTime?(t(),o("div",Fe,[N.value&&N.value>0?(t(),o("p",we," Started "+h(N.value)+" minute(s) ago ",1)):(t(),o("p",Ce,"Just started")),(t(!0),o(w,null,V(p.value,(k,D)=>(t(),o("div",Re,[i("div",Te,h(b(r).getPlayerName(k)),1),i("div",Se,[C(R,{showButtons:"",buttonLayout:"horizontal",modelValue:a.value[D],min:0,max:b(e).raceTo,"onUpdate:modelValue":Q=>x(D,Q)},{incrementbuttonicon:j(()=>[Be]),decrementbuttonicon:j(()=>[Ne]),_:2},1032,["modelValue","max","onUpdate:modelValue"])])]))),256))])):I("",!0),i("div",De,[s.value.startTime?I("",!0):(t(),F(g,{key:0,class:"mb-2",type:"button",label:z.value,disabled:A.value,onClick:S},null,8,["label","disabled"])),s.value.startTime&&!s.value.finishTime?(t(),F(g,{key:1,class:"mb-2",type:"button",label:"Update",severity:"info",onClick:c[0]||(c[0]=()=>B(!1))})):I("",!0),s.value.startTime&&!s.value.finishTime?(t(),F(g,{key:2,class:"mb-2",type:"button",label:"Finish",disabled:J.value,onClick:c[1]||(c[1]=()=>B(!0))},null,8,["disabled"])):I("",!0),C(g,{type:"button",label:"Close",severity:"secondary",onClick:c[2]||(c[2]=k=>u("hide"))})])]),_:1},8,["visible","header"])}}}),Ve={class:"flex flex-column md:flex-row justify-content-between md:align-items-end border-bottom-1 pb-1"},Pe=i("h1",null,"Fixtures",-1),je={class:"text-center"},We=T({__name:"FixtureList",setup(d){const _=P(),l=y(),u=y(""),r=y(!1),e=a=>{l.value=a,r.value=!0},m=a=>{u.value===a?u.value="":u.value=a},s=()=>{r.value=!1};return(a,p)=>(t(),o(w,null,[i("div",Ve,[Pe,i("h4",null,"Results remaining: "+h(b(_).remainingCount),1)]),(t(!0),o(w,null,V(b(_).rounds,(v,x)=>(t(),o("div",{class:$([x>0&&"border border-top-1"])},[i("h3",je,h(v.name),1),(t(!0),o(w,null,V(v.fixtures,(S,B)=>(t(),o("div",{class:$(["mt-1 pt-1 mb-1",[B>0&&"border-gray-200 border-top-1"]])},[C(ke,{result:S,highlightedResultId:u.value,onShowResultModal:()=>e(S),onHighlight:m},null,8,["result","highlightedResultId","onShowResultModal"])],2))),256))],2))),256)),l.value?(t(),F(Me,{key:0,visible:r.value,result:l.value,onHide:s},null,8,["visible","result"])):I("",!0)],64))}}),He=d=>(U("data-v-4f778d9b"),d=d(),q(),d),Ue={class:"p-fluid mt-2"},qe=He(()=>i("footer",null,[i("a",{href:"https://www.flaticon.com/free-icons/ball-eight",title:"ball eight icons"},"Ball eight icons created by Boris farias - Flaticon")],-1)),Ee=T({__name:"PlayView",setup(d){const _=X(),l=P(),u=L(),r=y("Fixtures"),e=y(!1),m=()=>{e.value=!0},s=()=>{l.finish(),a(),_.push({name:"results"})},a=()=>{e.value=!1};return(p,v)=>{const x=M("Button");return t(),o(w,null,[i("main",null,[r.value==="Fixtures"?(t(),F(We,{key:0})):I("",!0),i("div",Ue,[C(x,{label:"Finish",disabled:!b(u).allowEarlyFinish&&b(l).remainingCount>0,onClick:m},null,8,["disabled"])]),C(Y,{visible:e.value,header:"Finish Flyer",message:"Are you ready to finish the flyer?",onConfirm:s,onHide:a},null,8,["visible"])]),qe],64)}}}),Ae=E(Ee,[["__scopeId","data-v-4f778d9b"]]);export{Ae as default};
